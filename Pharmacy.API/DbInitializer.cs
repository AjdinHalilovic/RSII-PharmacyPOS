using Microsoft.EntityFrameworkCore;
using Pharmacy.Infrastructure.Contexts.Base;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;

namespace Pharmacy.API
{
    public static class DbInitializer
    {
        public static void Initialize(PharmacyContext context)
        {
            context.Database.Migrate();

            //if (context.Users.Any()) 
            //    return;

            //context.Database.ExecuteSqlCommand("SET IDENTITY_INSERT \"Countries\" ON insert into \"Countries\" (\"Id\", \"Name\", \"DeletedDateTime\") values (1, 'Bosna i Hercegovina', null); SET IDENTITY_INSERT \"Countries\" OFF SET IDENTITY_INSERT \"Cities\" ON insert into \"Cities\" (\"Id\", \"CountryId\", \"Name\", \"DeletedDateTime\") values (1, 1, 'Sarajevo', null); SET IDENTITY_INSERT \"Cities\" OFF SET IDENTITY_INSERT \"MeasurementUnits\" ON insert into \"MeasurementUnits\" (\"Id\", \"Name\", \"DeletedDateTime\", \"ShortName\") values (1, 'Mililiters', null, 'ml'); SET IDENTITY_INSERT \"MeasurementUnits\" OFF SET IDENTITY_INSERT \"Persons\" ON insert into \"Persons\" (\"Id\", \"FirstName\", \"LastName\", \"DateOfBirth\", \"CountryId\", \"CityId\", \"Address\", \"Note\", \"DeletedDateTime\") values (1, 'Test', 'Test', '2020-08-12 17:41:28.000000', null, null, null, null, null); insert into \"Persons\" (\"Id\", \"FirstName\", \"LastName\", \"DateOfBirth\", \"CountryId\", \"CityId\", \"Address\", \"Note\", \"DeletedDateTime\") values (6, 'Admin', 'Poslovnice', '2020-09-14 14:33:24.807462', 1, 1, 'teeeest', 'dddd', null); insert into \"Persons\" (\"Id\", \"FirstName\", \"LastName\", \"DateOfBirth\", \"CountryId\", \"CityId\", \"Address\", \"Note\", \"DeletedDateTime\") values (5, 'Mobile', 'Skladistar', '2020-09-14 12:33:00.000000', 1, 1, 'teeeest', 'dddd', null); insert into \"Persons\" (\"Id\", \"FirstName\", \"LastName\", \"DateOfBirth\", \"CountryId\", \"CityId\", \"Address\", \"Note\", \"DeletedDateTime\") values (4, 'Prodavac', 'Apotekar', '2020-09-14 12:31:00.000000', null, 1, 'test', 'test', null); insert into \"Persons\" (\"Id\", \"FirstName\", \"LastName\", \"DateOfBirth\", \"CountryId\", \"CityId\", \"Address\", \"Note\", \"DeletedDateTime\") values (3, 'Su', 'Admin', '2020-08-12 09:41:00.000000', 1, 1, 'josanica', '', null); insert into \"Persons\" (\"Id\", \"FirstName\", \"LastName\", \"DateOfBirth\", \"CountryId\", \"CityId\", \"Address\", \"Note\", \"DeletedDateTime\") values (9, 'Admin', 'Apoteka 2', null, null, null, null, null, null); SET IDENTITY_INSERT \"Persons\" OFF SET IDENTITY_INSERT \"Roles\" ON insert into \"Roles\" (\"Id\", \"Code\", \"Name\", \"RoleLevel\", \"DeletedDateTime\") values (1, 1, 'Super administrator', 1, null); insert into \"Roles\" (\"Id\", \"Code\", \"Name\", \"RoleLevel\", \"DeletedDateTime\") values (2, 2, 'Administrator', 1, null); insert into \"Roles\" (\"Id\", \"Code\", \"Name\", \"RoleLevel\", \"DeletedDateTime\") values (3, 3, 'Seller', 1, null); insert into \"Roles\" (\"Id\", \"Code\", \"Name\", \"RoleLevel\", \"DeletedDateTime\") values (4, 4, 'Stockman', 1, null); SET IDENTITY_INSERT \"Roles\" OFF insert into \"Users\" (\"Id\", \"Username\", \"Email\", \"Phone\", \"PasswordHash\", \"PasswordSalt\", \"CreatedDate\", \"DeletedDateTime\", \"AccessToken\", \"TokenExpirationDateTime\", \"RefreshToken\", \"RefreshTokenExpirationDateTime\", \"CreatedTokenDateTime\", \"UpdateDateTime\") values (1, 'test', 'test@\"Email\".ba', 000, 'test', 'test', '2020-08-12 17:41:06.000000', null, 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJQZXJzb24iOiIxIiwibmJmIjoxNTk3MjQ4NjUyLCJleHAiOjE1OTcyNDk4NTIsImlhdCI6MTU5NzI0ODY1MiwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NDQzNzAiLCJhdWQiOiJodHRwczovL2xvY2FsaG9zdDo0NDM3MCJ9.dbkEXlwqPL3d9Os95epRIJl6WfJ0YujQdelAiBilESA', '2020-08-12 18:30:52.656717', 'wXxz+rgdV8yO3AG9I7o1DMtX8w5B3TqqFb8LBsgNzpE=', '2020-08-13 18:10:52.657269', '2020-08-12 18:10:52.657369', null); insert into \"Users\" (\"Id\", \"Username\", \"Email\", \"Phone\", \"PasswordHash\", \"PasswordSalt\", \"CreatedDate\", \"DeletedDateTime\", \"AccessToken\", \"TokenExpirationDateTime\", \"RefreshToken\", \"RefreshTokenExpirationDateTime\", \"CreatedTokenDateTime\", \"UpdateDateTime\") values (4, 'desktopSeller', 'desktopSeller@hotmail.com', 066268485, 'u2NAwiPA4IjCW7xjIdJNA+4pA+KYDBqaOK+5EaDu+LY=', 'KnCwD8a7QulejWLY0gnqZQ==', '0001-01-01 00:00:00.000000', null, 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySWQiOiI0IiwiUGhhcm1hY3lJZCI6IjIiLCJQaGFybWFjeUJyYW5jaElkIjoiMiIsIkludmVudG9yeUlkIjoiMSIsIkxpc3QiOiJbe1wiSWRcIjo0LFwiVXNlcklkXCI6NCxcIlBoYXJtYWN5SWRcIjoyLFwiUGhhcm1hY3lCcmFuY2hJZFwiOjIsXCJSb2xlSWRcIjozLFwiRGVsZXRlZERhdGVUaW1lXCI6bnVsbCxcIlVzZXJcIjpudWxsLFwiUGhhcm1hY3lcIjpudWxsLFwiUGhhcm1hY3lCcmFuY2hcIjpudWxsLFwiUm9sZVwiOntcIklkXCI6MyxcIkNvZGVcIjozLFwiTmFtZVwiOlwiU2VsbGVyXCIsXCJSb2xlTGV2ZWxcIjoxLFwiRGVsZXRlZERhdGVUaW1lXCI6bnVsbH19XSIsIm5iZiI6MTYwMDA5NDY5MiwiZXhwIjoxNjAwMDk1ODkyLCJpYXQiOjE2MDAwOTQ2OTIsImlzcyI6Imh0dHBzOi8vbG9jYWxob3N0OjQ0MzcwIiwiYXVkIjoiaHR0cHM6Ly9sb2NhbGhvc3Q6NDQzNzAifQ.zUfD1vVDlZwGTmxOyJPq51WvXyWXzmLhcIV4f3QjvYw', '2020-09-14 17:04:53.096404', '4Zysu0TjNSbZJbqkosLWTRikmf65eRWa/HhzVg2CyTo=', '2020-09-15 16:44:53.097286', '2020-09-14 16:44:53.097472', '2020-09-14 14:36:45.461732'); insert into \"Users\" (\"Id\", \"Username\", \"Email\", \"Phone\", \"PasswordHash\", \"PasswordSalt\", \"CreatedDate\", \"DeletedDateTime\", \"AccessToken\", \"TokenExpirationDateTime\", \"RefreshToken\", \"RefreshTokenExpirationDateTime\", \"CreatedTokenDateTime\", \"UpdateDateTime\") values (5, 'mobileStockman', 'mobileStockman@gmail.com', 062548556, 'u2NAwiPA4IjCW7xjIdJNA+4pA+KYDBqaOK+5EaDu+LY=', 'KnCwD8a7QulejWLY0gnqZQ==', '0001-01-01 00:00:00.000000', null, null, null, null, null, null, '2020-09-14 14:36:12.686644'); insert into \"Users\" (\"Id\", \"Username\", \"Email\", \"Phone\", \"PasswordHash\", \"PasswordSalt\", \"CreatedDate\", \"DeletedDateTime\", \"AccessToken\", \"TokenExpirationDateTime\", \"RefreshToken\", \"RefreshTokenExpirationDateTime\", \"CreatedTokenDateTime\", \"UpdateDateTime\") values (6, 'desktop', 'destktop@gmail.com', 061112335, 'u2NAwiPA4IjCW7xjIdJNA+4pA+KYDBqaOK+5EaDu+LY=', 'KnCwD8a7QulejWLY0gnqZQ==', '0001-01-01 00:00:00.000000', null, null, null, null, null, null, null); insert into \"Users\" (\"Id\", \"Username\", \"Email\", \"Phone\", \"PasswordHash\", \"PasswordSalt\", \"CreatedDate\", \"DeletedDateTime\", \"AccessToken\", \"TokenExpirationDateTime\", \"RefreshToken\", \"RefreshTokenExpirationDateTime\", \"CreatedTokenDateTime\", \"UpdateDateTime\") values (9, 'admin2', 'admin2@ggmail.com', null, 'u2NAwiPA4IjCW7xjIdJNA+4pA+KYDBqaOK+5EaDu+LY=', 'KnCwD8a7QulejWLY0gnqZQ==', '2020-09-14 21:07:57.749753', null, 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySWQiOiI5IiwiUGhhcm1hY3lJZCI6IjIiLCJQaGFybWFjeUJyYW5jaElkIjoiNCIsIkludmVudG9yeUlkIjoiMiIsIkxpc3QiOiJbe1wiSWRcIjo3LFwiVXNlcklkXCI6OSxcIlBoYXJtYWN5SWRcIjoyLFwiUGhhcm1hY3lCcmFuY2hJZFwiOjQsXCJSb2xlSWRcIjoyLFwiRGVsZXRlZERhdGVUaW1lXCI6bnVsbCxcIlVzZXJcIjpudWxsLFwiUGhhcm1hY3lcIjpudWxsLFwiUGhhcm1hY3lCcmFuY2hcIjpudWxsLFwiUm9sZVwiOntcIklkXCI6MixcIkNvZGVcIjoyLFwiTmFtZVwiOlwiQWRtaW5pc3RyYXRvclwiLFwiUm9sZUxldmVsXCI6MSxcIkRlbGV0ZWREYXRlVGltZVwiOm51bGx9fV0iLCJuYmYiOjE2MDAxMTA1ODUsImV4cCI6MTYwMDExMTc4NSwiaWF0IjoxNjAwMTEwNTg1LCJpc3MiOiJodHRwczovL2xvY2FsaG9zdDo0NDM3MCIsImF1ZCI6Imh0dHBzOi8vbG9jYWxob3N0OjQ0MzcwIn0.x2n4KA888x_Gtah3SYNf3V04-hupzCo77pOoeNBWYO8', '2020-09-14 21:29:45.982972', 'HeLnvmUCMQxpc8yJSRf989MMemu6ndX93Ffx5/IJMRQ=', '2020-09-15 21:09:45.983433', '2020-09-14 21:09:45.983635', null); insert into \"Users\" (\"Id\", \"Username\", \"Email\", \"Phone\", \"PasswordHash\", \"PasswordSalt\", \"CreatedDate\", \"DeletedDateTime\", \"AccessToken\", \"TokenExpirationDateTime\", \"RefreshToken\", \"RefreshTokenExpirationDateTime\", \"CreatedTokenDateTime\", \"UpdateDateTime\") values (3, 'admin', 'su.desktop@\"Email\"', 060222333, 'u2NAwiPA4IjCW7xjIdJNA+4pA+KYDBqaOK+5EaDu+LY=', 'KnCwD8a7QulejWLY0gnqZQ==', '2020-08-14 16:30:20.650927', null, 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySWQiOiIzIiwiUGhhcm1hY3lJZCI6IjIiLCJQaGFybWFjeUJyYW5jaElkIjoiMiIsIkludmVudG9yeUlkIjoiMSIsIkxpc3QiOiJbe1wiSWRcIjozLFwiVXNlcklkXCI6MyxcIlBoYXJtYWN5SWRcIjoyLFwiUGhhcm1hY3lCcmFuY2hJZFwiOjIsXCJSb2xlSWRcIjoxLFwiRGVsZXRlZERhdGVUaW1lXCI6bnVsbCxcIlVzZXJcIjpudWxsLFwiUGhhcm1hY3lcIjpudWxsLFwiUGhhcm1hY3lCcmFuY2hcIjpudWxsLFwiUm9sZVwiOntcIklkXCI6MSxcIkNvZGVcIjoxLFwiTmFtZVwiOlwiU3VwZXIgYWRtaW5pc3RyYXRvclwiLFwiUm9sZUxldmVsXCI6MSxcIkRlbGV0ZWREYXRlVGltZVwiOm51bGx9fV0iLCJuYmYiOjE2MDAxMDcxMTMsImV4cCI6MTYwMDEwODMxMywiaWF0IjoxNjAwMTA3MTEzLCJpc3MiOiJodHRwczovL2xvY2FsaG9zdDo0NDM3MCIsImF1ZCI6Imh0dHBzOi8vbG9jYWxob3N0OjQ0MzcwIn0.NUKELUHF1KVI3moUwSCaWlEq1L_7kT1EhhWvz7chPh8', '2020-09-14 20:31:54.103854', 'XvBn/n2QpxLLoZ/XTcGxl13if3+H41wMiCuZZbomohA=', '2020-09-15 20:11:54.104497', '2020-09-14 20:11:54.104603', '2020-09-14 14:37:32.214073'); SET IDENTITY_INSERT \"Pharmacies\" ON insert into \"Pharmacies\" (\"Id\", \"Name\", \"PharmacyUniqueIdentifier\", \"OwnerUserId\", \"DeletedDateTime\") values (2, 'Apoteka demo', 000, 3, null); SET IDENTITY_INSERT \"Pharmacies\" OFF SET IDENTITY_INSERT \"PharmacyBranches\" ON insert into \"PharmacyBranches\" (\"Id\", \"PharmacyId\", \"CountryId\", \"CityId\", \"Address\", \"BranchIdentifier\", \"Central\", \"DeletedDateTime\") values (2, 2, 1, 1, 'adresa demo', '000-1', 'true', null); insert into \"PharmacyBranches\" (\"Id\", \"PharmacyId\", \"CountryId\", \"CityId\", \"Address\", \"BranchIdentifier\", \"Central\", \"DeletedDateTime\") values (4, 2, 1, 1, 'test', '000 - 2', 'false', null); SET IDENTITY_INSERT \"PharmacyBranches\" OFF SET IDENTITY_INSERT \"Attributes\" ON insert into \"Attributes\" (\"Id\", \"PharmacyBranchId\", \"Name\", \"DeletedDateTime\") values (1, 2, 'Boja', null); insert into \"Attributes\" (\"Id\", \"PharmacyBranchId\", \"Name\", \"DeletedDateTime\") values (2, 2, 'Prirodno stanje', null); SET IDENTITY_INSERT \"Attributes\" OFF SET IDENTITY_INSERT \"AttributeOptions\" ON insert into \"AttributeOptions\" (\"Id\", \"AttributeId\", \"Value\", \"DeletedDateTime\") values (1, 1, 'Plava', null); insert into \"AttributeOptions\" (\"Id\", \"AttributeId\", \"Value\", \"DeletedDateTime\") values (2, 1, 'Zuta', null); insert into \"AttributeOptions\" (\"Id\", \"AttributeId\", \"Value\", \"DeletedDateTime\") values (3, 2, 'Prah', null); insert into \"AttributeOptions\" (\"Id\", \"AttributeId\", \"Value\", \"DeletedDateTime\") values (5, 2, 'Tecnost', null); insert into \"AttributeOptions\" (\"Id\", \"AttributeId\", \"Value\", \"DeletedDateTime\") values (4, 2, 'Mast', '2020-08-20 13:29:17.898186'); insert into \"AttributeOptions\" (\"Id\", \"AttributeId\", \"Value\", \"DeletedDateTime\") values (6, 2, 'Kapsule', null); SET IDENTITY_INSERT \"AttributeOptions\" OFF SET IDENTITY_INSERT \"Categories\" ON insert into \"Categories\" (\"Id\", \"PharmacyBranchId\", \"Name\", \"DeletedDateTime\") values (1, 2, 'Kreme', null); insert into \"Categories\" (\"Id\", \"PharmacyBranchId\", \"Name\", \"DeletedDateTime\") values (2, 2, 'Maze', null); SET IDENTITY_INSERT \"Categories\" OFF SET IDENTITY_INSERT \"Inventories\" ON insert into \"Inventories\" (\"Id\", \"PharmacyBranchId\", \"DeletedDateTime\") values (1, 2, null); insert into \"Inventories\" (\"Id\", \"PharmacyBranchId\", \"DeletedDateTime\") values (2, 4, null); SET IDENTITY_INSERT \"Inventories\" OFF SET IDENTITY_INSERT \"InventoryEntries\" ON insert into \"InventoryEntries\" (\"Id\", \"InventoryId\", \"EntryDateTime\", \"UserId\", \"EntryNumber\", \"DeletedDateTime\") values (4, 1, '2020-09-13 15:15:48.782634', 3, 1234, null); insert into \"InventoryEntries\" (\"Id\", \"InventoryId\", \"EntryDateTime\", \"UserId\", \"EntryNumber\", \"DeletedDateTime\") values (5, 1, '2020-09-13 15:18:51.461879', 3, 153548, null); SET IDENTITY_INSERT \"InventoryEntries\" OFF SET IDENTITY_INSERT \"PharmacyBranchUsers\" ON insert into \"PharmacyBranchUsers\" (\"Id\", \"PharmacyBranchId\", \"UserId\", \"StartDateTime\", \"EndDateTime\", \"DeletedDateTime\") values (1, 2, 3, '2020-08-14 16:30:20.779759', null, null); insert into \"PharmacyBranchUsers\" (\"Id\", \"PharmacyBranchId\", \"UserId\", \"StartDateTime\", \"EndDateTime\", \"DeletedDateTime\") values (2, 2, 4, '2020-09-14 14:33:17.164428', null, null); insert into \"PharmacyBranchUsers\" (\"Id\", \"PharmacyBranchId\", \"UserId\", \"StartDateTime\", \"EndDateTime\", \"DeletedDateTime\") values (3, 2, 5, '2020-09-14 14:34:32.246595', null, null); insert into \"PharmacyBranchUsers\" (\"Id\", \"PharmacyBranchId\", \"UserId\", \"StartDateTime\", \"EndDateTime\", \"DeletedDateTime\") values (4, 2, 6, '2020-09-14 14:35:41.999960', null, null); insert into \"PharmacyBranchUsers\" (\"Id\", \"PharmacyBranchId\", \"UserId\", \"StartDateTime\", \"EndDateTime\", \"DeletedDateTime\") values (5, 4, 9, '2020-09-14 21:08:08.677113', null, null); SET IDENTITY_INSERT \"PharmacyBranchUsers\" OFF SET IDENTITY_INSERT \"Products\" ON insert into \"Products\" (\"Id\", \"PharmacyBranchId\", \"Name\", \"Code\", \"Description\", \"DeletedDateTime\", \"MeasurementUnitId\", \"Price\") values (1, 2, 'Tablete', 00001, 'tabletice', null, 1, 7.5); insert into \"Products\" (\"Id\", \"PharmacyBranchId\", \"Name\", \"Code\", \"Description\", \"DeletedDateTime\", \"MeasurementUnitId\", \"Price\") values (2, 2, 'Lakaluk', '\"Code\" 0012', 'desc', null, 1, 5); insert into \"Products\" (\"Id\", \"PharmacyBranchId\", \"Name\", \"Code\", \"Description\", \"DeletedDateTime\", \"MeasurementUnitId\", \"Price\") values (3, 2, 'Paracetamol', 'PC', 'desc', null, 1, 2.5); SET IDENTITY_INSERT \"Products\" OFF SET IDENTITY_INSERT \"InventoryProducts\" ON insert into \"InventoryProducts\" (\"Id\", \"InventoryId\", \"ProductId\", \"Quantity\", \"DeletedDateTime\") values (1, 1, 2, 10, null); insert into \"InventoryProducts\" (\"Id\", \"InventoryId\", \"ProductId\", \"Quantity\", \"DeletedDateTime\") values (3, 1, 1, 15, null); insert into \"InventoryProducts\" (\"Id\", \"InventoryId\", \"ProductId\", \"Quantity\", \"DeletedDateTime\") values (2, 1, 3, 19, null); SET IDENTITY_INSERT \"InventoryProducts\" OFF SET IDENTITY_INSERT \"ProductAttributes\" ON insert into \"ProductAttributes\" (\"Id\", \"ProductId\", \"AttributeId\", \"AttributeOptionId\", \"DeletedDateTime\") values (1, 1, 1, 1, null); insert into \"ProductAttributes\" (\"Id\", \"ProductId\", \"AttributeId\", \"AttributeOptionId\", \"DeletedDateTime\") values (2, 2, 1, 1, '2020-08-20 12:31:10.109881'); insert into \"ProductAttributes\" (\"Id\", \"ProductId\", \"AttributeId\", \"AttributeOptionId\", \"DeletedDateTime\") values (3, 2, 1, 2, null); insert into \"ProductAttributes\" (\"Id\", \"ProductId\", \"AttributeId\", \"AttributeOptionId\", \"DeletedDateTime\") values (4, 3, 1, 2, null); SET IDENTITY_INSERT \"ProductAttributes\" OFF SET IDENTITY_INSERT \"ProductCategories\" ON insert into \"ProductCategories\" (\"Id\", \"ProductId\", \"CategoryId\", \"DeletedDateTime\") values (1, 1, 1, null); insert into \"ProductCategories\" (\"Id\", \"ProductId\", \"CategoryId\", \"DeletedDateTime\") values (2, 2, 2, '2020-08-20 12:14:00.718086'); insert into \"ProductCategories\" (\"Id\", \"ProductId\", \"CategoryId\", \"DeletedDateTime\") values (3, 2, 1, '2020-08-20 12:22:18.757344'); insert into \"ProductCategories\" (\"Id\", \"ProductId\", \"CategoryId\", \"DeletedDateTime\") values (4, 3, 1, null); insert into \"ProductCategories\" (\"Id\", \"ProductId\", \"CategoryId\", \"DeletedDateTime\") values (5, 3, 2, null); SET IDENTITY_INSERT \"ProductCategories\" OFF SET IDENTITY_INSERT \"Substances\" ON insert into \"Substances\" (\"Id\", \"PharmacyBranchId\", \"Name\", \"DeletedDateTime\") values (1, 2, 'Substanca test', null); insert into \"Substances\" (\"Id\", \"PharmacyBranchId\", \"Name\", \"DeletedDateTime\") values (2, 2, 'Sulfat', null); insert into \"Substances\" (\"Id\", \"PharmacyBranchId\", \"Name\", \"DeletedDateTime\") values (4, 2, 'Aminokiselina C193', null); insert into \"Substances\" (\"Id\", \"PharmacyBranchId\", \"Name\", \"DeletedDateTime\") values (3, 2, 'Nitrat', null); SET IDENTITY_INSERT \"Substances\" OFF SET IDENTITY_INSERT \"ProductSubstances\" ON insert into \"ProductSubstances\" (\"Id\", \"ProductId\", \"SubstanceId\", \"DeletedDateTime\") values (1, 1, 1, null); insert into \"ProductSubstances\" (\"Id\", \"ProductId\", \"SubstanceId\", \"DeletedDateTime\") values (2, 2, 1, '2020-08-20 12:14:04.285717'); insert into \"ProductSubstances\" (\"Id\", \"ProductId\", \"SubstanceId\", \"DeletedDateTime\") values (3, 2, 1, null); insert into \"ProductSubstances\" (\"Id\", \"ProductId\", \"SubstanceId\", \"DeletedDateTime\") values (4, 3, 1, null); insert into \"ProductSubstances\" (\"Id\", \"ProductId\", \"SubstanceId\", \"DeletedDateTime\") values (5, 3, 1, null); SET IDENTITY_INSERT \"ProductSubstances\" OFF SET IDENTITY_INSERT \"ProhibitedSubstances\" ON insert into \"ProhibitedSubstances\" (\"Id\", \"SubstanceId\", \"ProhibitedSubstanceId\", \"DeletedDateTime\") values (1, 4, 3, '2020-09-14 14:12:17.465387'); insert into \"ProhibitedSubstances\" (\"Id\", \"SubstanceId\", \"ProhibitedSubstanceId\", \"DeletedDateTime\") values (2, 4, 3, null); insert into \"ProhibitedSubstances\" (\"Id\", \"SubstanceId\", \"ProhibitedSubstanceId\", \"DeletedDateTime\") values (3, 3, 4, null); SET IDENTITY_INSERT \"ProhibitedSubstances\" OFF SET IDENTITY_INSERT \"UserRoles\" ON insert into \"UserRoles\" (\"Id\", \"UserId\", \"PharmacyId\", \"PharmacyBranchId\", \"DeletedDateTime\", \"RoleId\") values (3, 3, 2, 2, null, 1); insert into \"UserRoles\" (\"Id\", \"UserId\", \"PharmacyId\", \"PharmacyBranchId\", \"DeletedDateTime\", \"RoleId\") values (4, 4, 2, 2, null, 3); insert into \"UserRoles\" (\"Id\", \"UserId\", \"PharmacyId\", \"PharmacyBranchId\", \"DeletedDateTime\", \"RoleId\") values (5, 5, 2, 2, null, 4); insert into \"UserRoles\" (\"Id\", \"UserId\", \"PharmacyId\", \"PharmacyBranchId\", \"DeletedDateTime\", \"RoleId\") values (6, 6, 2, 2, null, 2); insert into \"UserRoles\" (\"Id\", \"UserId\", \"PharmacyId\", \"PharmacyBranchId\", \"DeletedDateTime\", \"RoleId\") values (7, 9, 2, 4, null, 2); SET IDENTITY_INSERT \"UserRoles\" OFF SET IDENTITY_INSERT \"InventoryEntryProducts\" ON insert into \"InventoryEntryProducts\" (\"Id\", \"InventoryEntryId\", \"ProductId\", \"Quantity\", \"DeletedDateTime\") values (3, 4, 3, 25, null); insert into \"InventoryEntryProducts\" (\"Id\", \"InventoryEntryId\", \"ProductId\", \"Quantity\", \"DeletedDateTime\") values (4, 5, 1, 15, null); insert into \"InventoryEntryProducts\" (\"Id\", \"InventoryEntryId\", \"ProductId\", \"Quantity\", \"DeletedDateTime\") values (5, 4, 2, 10, null); SET IDENTITY_INSERT \"InventoryEntryProducts\" OFF SET IDENTITY_INSERT \"WriteOffInventoryDocuments\" ON insert into \"WriteOffInventoryDocuments\" (\"Id\", \"InventoryProductId\", \"WriteOffDateTime\", \"Quantity\", \"DeletedDateTime\", \"UserId\", \"Reason\") values (1, 2, '2020-09-13 20:53:31.538176', 2, null, 3, 'Isteko rok'); insert into \"WriteOffInventoryDocuments\" (\"Id\", \"InventoryProductId\", \"WriteOffDateTime\", \"Quantity\", \"DeletedDateTime\", \"UserId\", \"Reason\") values (2, 2, '2020-09-13 20:56:22.613651', 4, null, 3, 'Rok opet'); SET IDENTITY_INSERT \"WriteOffInventoryDocuments\" OFF");
            //context.Database.ExecuteSqlCommand("CREATE PROCEDURE fn_users_getloginbyusertokens @pAccessToken nvarchar(max),@pRefreshToken nvarchar(max) AS SELECT \"U\".\"Id\", \"U\".\"AccessToken\", \"U\".\"Id\" AS \"UserId\" FROM \"Users\" AS \"U\" WHERE \"U\".\"DeletedDateTime\" IS NULL AND CURRENT_TIMESTAMP < \"U\".\"RefreshTokenExpirationDateTime\" AND CAST(\"U\".\"AccessToken\" as nvarchar(max)) = @pAccessToken AND CAST(\"U\".\"RefreshToken\" as nvarchar(max))= @pRefreshToken;");
            //context.Database.ExecuteSqlCommand("CREATE PROCEDURE fn_users_getloginbyuserid @pUserId int AS SELECT \"U\".\"Id\", \"PharmacyBranch\".\"PharmacyId\", \"PharmacyBranch\".\"PharmacyBranchId\", \"PharmacyBranch\".\"InventoryId\", \"U\".\"AccessToken\", \"U\".\"Id\" AS \"UserId\", CONVERT(BIT,CASE WHEN \"U\".\"DeletedDateTime\" IS NULL THEN 1 ELSE 0 END) AS \"Active\", CAST(concat(\"P\".\"FirstName\", ' ', \"P\".\"LastName\") as nvarchar(max)) AS \"UserFullName\" FROM \"Users\" AS \"U\" JOIN \"Persons\" AS \"P\" ON \"P\".\"Id\" = \"U\".\"Id\" OUTER APPLY ( SELECT TOP 1 \"PBU\".\"PharmacyBranchId\", \"PB\".\"PharmacyId\", \"I\".\"Id\" AS \"InventoryId\" FROM \"PharmacyBranchUsers\" AS \"PBU\" JOIN \"PharmacyBranches\" AS \"PB\" ON \"PBU\".\"PharmacyBranchId\" = \"PB\".\"Id\" JOIN \"Inventories\" AS \"I\" ON \"PB\".\"Id\" = \"I\".\"PharmacyBranchId\" WHERE \"PBU\".\"UserId\" = \"U\".\"Id\" AND \"PBU\".\"EndDateTime\" IS NULL AND \"PBU\".\"DeletedDateTime\" IS NULL AND \"PB\".\"DeletedDateTime\" IS NULL AND \"I\".\"DeletedDateTime\" IS NULL ) AS \"PharmacyBranch\" WHERE \"U\".\"Id\" = @pUserId;");
            //context.Database.ExecuteSqlCommand("CREATE PROCEDURE fn_productsubstances_anyprohibitedsubstance @pProductId int, @pProductIds nvarchar(max) AS SELECT CASE WHEN EXISTS ( SELECT \"PHS\".\"Id\" FROM \"ProductSubstances\" AS \"PS\" JOIN \"Substances\" AS \"S\" ON \"PS\".\"SubstanceId\" = \"S\".\"Id\" JOIN \"ProhibitedSubstances\" AS \"PHS\" ON \"S\".\"Id\" = \"PHS\".\"ProhibitedSubstanceId\" OR \"S\".\"Id\" = \"PHS\".\"SubstanceId\" OUTER APPLY ( SELECT TOP 1 \"PHS2\".\"Id\" FROM \"ProhibitedSubstances\" AS \"PHS2\" JOIN \"Substances\" \"S2\" on \"PHS2\".\"ProhibitedSubstanceId\" = \"S2\".\"Id\" OR \"PHS2\".\"SubstanceId\" = \"S2\".\"Id\" JOIN \"ProductSubstances\" AS \"PS2\" ON \"PS2\".\"SubstanceId\" = \"S2\".\"Id\" WHERE \"PS2\".\"ProductId\" IN (SELECT CAST(\"VALUES\".value AS INT) FROM string_split(@pProductIds, ',') AS \"VALUES\") AND (\"PHS\".\"SubstanceId\" = \"S2\".\"Id\" OR \"PHS\".\"ProhibitedSubstanceId\" = \"S2\".\"Id\") ) AS \"Prohibited\" WHERE \"PS\".\"ProductId\" = @pProductId AND \"PS\".\"DeletedDateTime\" IS NULL AND \"Prohibited\".\"Id\" IS NOT NULL ) THEN CONVERT(bit,'TRUE') ELSE CONVERT(bit,'FALSE') END;");
            //context.Database.ExecuteSqlCommand("CREATE PROCEDURE fn_products_getdtosbyparameters @pPharmacyBranchId int, @pSearchTerm nvarchar(max), @pCategoryId int AS SELECT \"P\".\"Id\", \"P\".\"Name\", \"P\".\"Code\", \"P\".\"Description\", \"MU\".\"Name\" AS \"MeasurementUnit\", \"FormatedCategories\".\"Categories\", \"ProductSubstance\".\"SubstancesNumber\", \"ProductAttribute\".\"AttributeNumber\", \"Inventory\".\"Quantity\", \"P\".\"Price\" FROM \"Products\" AS \"P\" LEFT JOIN \"MeasurementUnits\" AS \"MU\" ON \"P\".\"MeasurementUnitId\" = \"MU\".\"Id\" OUTER APPLY ( SELECT TOP 1 string_agg(\"C\".\"Name\", ', ') AS \"Categories\" FROM \"ProductCategories\" AS \"PC\" JOIN \"Categories\" \"C\" on \"PC\".\"CategoryId\" = \"C\".\"Id\" WHERE \"PC\".\"DeletedDateTime\" IS NULL AND \"PC\".\"ProductId\" = \"P\".\"Id\" AND (\"PC\".\"CategoryId\" = @pCategoryId OR @pCategoryId IS NULL) ) AS \"FormatedCategories\" OUTER APPLY ( SELECT TOP 1 CAST(COUNT(*) AS INT) AS \"SubstancesNumber\" FROM \"ProductSubstances\" AS \"PS\" WHERE \"PS\".\"DeletedDateTime\" IS NULL AND \"PS\".\"ProductId\" = \"P\".\"Id\" ) AS \"ProductSubstance\" OUTER APPLY ( SELECT TOP 1 CAST(COUNT(*) as int) AS \"AttributeNumber\" FROM \"ProductAttributes\" AS \"PA\" WHERE \"PA\".\"DeletedDateTime\" IS NULL AND \"PA\".\"ProductId\" = \"P\".\"Id\" ) AS \"ProductAttribute\" OUTER APPLY ( SELECT TOP 1 \"IP\".\"Quantity\" FROM \"InventoryProducts\" AS \"IP\" WHERE \"IP\".\"DeletedDateTime\" IS NULL AND \"IP\".\"ProductId\" = \"P\".\"Id\" ) AS \"Inventory\" OUTER APPLY( SELECT TOP 1 CAST(COUNT(*) as int) AS \"Total\" FROM \"BillItems\" AS \"BI\" WHERE \"BI\".\"ProductId\" = \"P\".\"Id\" AND \"BI\".\"DeletedDateTime\" IS NULL ) AS \"SoldProducts\" WHERE \"P\".\"DeletedDateTime\" IS NULL AND \"P\".\"PharmacyBranchId\" = @pPharmacyBranchId AND (@pSearchTerm IS NULL OR LOWER(\"P\".\"Name\") LIKE '%'+LOWER(@pSearchTerm)+'%') AND (@pCategoryId IS NULL OR (@pCategoryId IS NOT NULL AND \"FormatedCategories\".\"Categories\" IS NOT NULL)) ORDER BY \"SoldProducts\".\"Total\" DESC ;");
            //context.Database.ExecuteSqlCommand("CREATE PROCEDURE fn_persons_getdtosbyparameters @pFullName nvarchar(max), @pPharmacyBranchId int AS SELECT \"P\".\"Id\", cast(concat(\"P\".\"FirstName\", ' ', \"P\".\"LastName\") as nvarchar(max)) AS \"FullName\", \"P\".\"DateOfBirth\", \"U\".\"Email\", \"U\".\"Phone\", \"CT\".\"Name\" AS \"Country\", \"C\".\"Name\" AS \"City\", \"P\".\"Address\" FROM \"Persons\" AS \"P\" JOIN \"Users\" AS \"U\" ON \"P\".\"Id\" = \"U\".\"Id\" JOIN \"PharmacyBranchUsers\" AS \"PBU\" ON \"U\".\"Id\" = \"PBU\".\"UserId\" LEFT JOIN \"Countries\" AS \"CT\" ON \"P\".\"CountryId\" = \"CT\".\"Id\" LEFT JOIN \"Cities\" AS \"C\" ON \"P\".\"CityId\" = \"C\".\"Id\" WHERE \"P\".\"DeletedDateTime\" IS NULL AND (@pFullName IS NULL OR LOWER(CONCAT(\"P\".\"FirstName\", ' ', \"P\".\"LastName\")) LIKE '%'+LOWER(@pFullName)+'%') AND \"PBU\".\"EndDateTime\" IS NULL AND \"PBU\".\"DeletedDateTime\" IS NULL AND \"PBU\".\"PharmacyBranchId\" = @pPharmacyBranchId;");
            //context.Database.ExecuteSqlCommand("CREATE PROCEDURE fn_inventoryentries_getdtosbyparameters @pPharmacyBranchId int, @pSearchTerm nvarchar(max) AS SELECT \"IE\".\"Id\", \"IE\".\"EntryNumber\", \"IE\".\"EntryDateTime\", cast(concat(\"P\".\"FirstName\", ' ', \"P\".\"LastName\") as nvarchar(max)) AS \"FullName\" FROM \"InventoryEntries\" AS \"IE\" JOIN \"Inventories\" AS \"I\" ON \"IE\".\"InventoryId\" = \"I\".\"Id\" JOIN \"Users\" AS \"U\" ON \"IE\".\"UserId\" = \"U\".\"Id\" JOIN \"Persons\" AS \"P\" ON \"U\".\"Id\" = \"P\".\"Id\" WHERE \"IE\".\"DeletedDateTime\" IS NULL AND \"I\".\"PharmacyBranchId\" = @pPharmacyBranchId AND (@pSearchTerm IS NULL OR \"IE\".\"EntryNumber\" LIKE '%'+lower(@pSearchTerm)+'%');");

            //context.SaveChanges();
        }
    }
}
